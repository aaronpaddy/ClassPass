const sqlite3 = require('sqlite3').verbose();
const path = require('path');

// Connect to database
const db = new sqlite3.Database('database.sqlite');

// Sample face descriptors for different people
const sampleUsers = [
    {
        name: "Alice Johnson",
        email: "alice@test.com",
        userId: "A001",
        department: "Engineering",
        faces: [
            // Alice's face descriptor (different from your face)
            {
                descriptor: {
                    "0": 0.1, "1": -0.2, "2": 0.3, "3": -0.1, "4": 0.2, "5": -0.3, "6": 0.1, "7": -0.2,
                    "8": 0.3, "9": -0.1, "10": 0.2, "11": -0.3, "12": 0.1, "13": -0.2, "14": 0.3, "15": -0.1,
                    "16": 0.2, "17": -0.3, "18": 0.1, "19": -0.2, "20": 0.3, "21": -0.1, "22": 0.2, "23": -0.3,
                    "24": 0.1, "25": -0.2, "26": 0.3, "27": -0.1, "28": 0.2, "29": -0.3, "30": 0.1, "31": -0.2,
                    "32": 0.3, "33": -0.1, "34": 0.2, "35": -0.3, "36": 0.1, "37": -0.2, "38": 0.3, "39": -0.1,
                    "40": 0.2, "41": -0.3, "42": 0.1, "43": -0.2, "44": 0.3, "45": -0.1, "46": 0.2, "47": -0.3,
                    "48": 0.1, "49": -0.2, "50": 0.3, "51": -0.1, "52": 0.2, "53": -0.3, "54": 0.1, "55": -0.2,
                    "56": 0.3, "57": -0.1, "58": 0.2, "59": -0.3, "60": 0.1, "61": -0.2, "62": 0.3, "63": -0.1,
                    "64": 0.2, "65": -0.3, "66": 0.1, "67": -0.2, "68": 0.3, "69": -0.1, "70": 0.2, "71": -0.3,
                    "72": 0.1, "73": -0.2, "74": 0.3, "75": -0.1, "76": 0.2, "77": -0.3, "78": 0.1, "79": -0.2,
                    "80": 0.3, "81": -0.1, "82": 0.2, "83": -0.3, "84": 0.1, "85": -0.2, "86": 0.3, "87": -0.1,
                    "88": 0.2, "89": -0.3, "90": 0.1, "91": -0.2, "92": 0.3, "93": -0.1, "94": 0.2, "95": -0.3,
                    "96": 0.1, "97": -0.2, "98": 0.3, "99": -0.1, "100": 0.2, "101": -0.3, "102": 0.1, "103": -0.2,
                    "104": 0.3, "105": -0.1, "106": 0.2, "107": -0.3, "108": 0.1, "109": -0.2, "110": 0.3, "111": -0.1,
                    "112": 0.2, "113": -0.3, "114": 0.1, "115": -0.2, "116": 0.3, "117": -0.1, "118": 0.2, "119": -0.3,
                    "120": 0.1, "121": -0.2, "122": 0.3, "123": -0.1, "124": 0.2, "125": -0.3, "126": 0.1, "127": -0.2
                }
            }
        ]
    },
    {
        name: "Bob Smith",
        email: "bob@test.com",
        userId: "B002",
        department: "Marketing",
        faces: [
            // Bob's face descriptor (very different from your face)
            {
                descriptor: {
                    "0": -0.5, "1": 0.8, "2": -0.3, "3": 0.6, "4": -0.2, "5": 0.7, "6": -0.4, "7": 0.9,
                    "8": -0.1, "9": 0.5, "10": -0.6, "11": 0.3, "12": -0.8, "13": 0.2, "14": -0.4, "15": 0.7,
                    "16": -0.3, "17": 0.6, "18": -0.2, "19": 0.8, "20": -0.5, "21": 0.4, "22": -0.7, "23": 0.1,
                    "24": -0.9, "25": 0.3, "26": -0.6, "27": 0.5, "28": -0.2, "29": 0.8, "30": -0.4, "31": 0.7,
                    "32": -0.1, "33": 0.6, "34": -0.3, "35": 0.9, "36": -0.5, "37": 0.2, "38": -0.8, "39": 0.4,
                    "40": -0.7, "41": 0.1, "42": -0.6, "43": 0.5, "44": -0.3, "45": 0.8, "46": -0.2, "47": 0.7,
                    "48": -0.4, "49": 0.6, "50": -0.1, "51": 0.9, "52": -0.5, "53": 0.3, "54": -0.8, "55": 0.2,
                    "56": -0.7, "57": 0.4, "58": -0.6, "59": 0.1, "60": -0.9, "61": 0.5, "62": -0.3, "63": 0.8,
                    "64": -0.2, "65": 0.7, "66": -0.4, "67": 0.6, "68": -0.1, "69": 0.9, "70": -0.5, "71": 0.3,
                    "72": -0.8, "73": 0.2, "74": -0.7, "75": 0.4, "76": -0.6, "77": 0.1, "78": -0.9, "79": 0.5,
                    "80": -0.3, "81": 0.8, "82": -0.2, "83": 0.7, "84": -0.4, "85": 0.6, "86": -0.1, "87": 0.9,
                    "88": -0.5, "89": 0.3, "90": -0.8, "91": 0.2, "92": -0.7, "93": 0.4, "94": -0.6, "95": 0.1,
                    "96": -0.9, "97": 0.5, "98": -0.3, "99": 0.8, "100": -0.2, "101": 0.7, "102": -0.4, "103": 0.6,
                    "104": -0.1, "105": 0.9, "106": -0.5, "107": 0.3, "108": -0.8, "109": 0.2, "110": -0.7, "111": 0.4,
                    "112": -0.6, "113": 0.1, "114": -0.9, "115": 0.5, "116": -0.3, "117": 0.8, "118": -0.2, "119": 0.7,
                    "120": -0.4, "121": 0.6, "122": -0.1, "123": 0.9, "124": -0.5, "125": 0.3, "126": -0.8, "127": 0.2
                }
            }
        ]
    },
    {
        name: "Carol Davis",
        email: "carol@test.com",
        userId: "C003",
        department: "HR",
        faces: [
            // Carol's face descriptor (completely different pattern)
            {
                descriptor: {
                    "0": 0.9, "1": -0.1, "2": 0.8, "3": -0.2, "4": 0.7, "5": -0.3, "6": 0.6, "7": -0.4,
                    "8": 0.5, "9": -0.5, "10": 0.4, "11": -0.6, "12": 0.3, "13": -0.7, "14": 0.2, "15": -0.8,
                    "16": 0.1, "17": -0.9, "18": 0.0, "19": -0.1, "20": 0.9, "21": -0.2, "22": 0.8, "23": -0.3,
                    "24": 0.7, "25": -0.4, "26": 0.6, "27": -0.5, "28": 0.5, "29": -0.6, "30": 0.4, "31": -0.7,
                    "32": 0.3, "33": -0.8, "34": 0.2, "35": -0.9, "36": 0.1, "37": -0.1, "38": 0.0, "39": -0.2,
                    "40": 0.9, "41": -0.3, "42": 0.8, "43": -0.4, "44": 0.7, "45": -0.5, "46": 0.6, "47": -0.6,
                    "48": 0.5, "49": -0.7, "50": 0.4, "51": -0.8, "52": 0.3, "53": -0.9, "54": 0.2, "55": -0.1,
                    "56": 0.1, "57": -0.2, "58": 0.0, "59": -0.3, "60": 0.9, "61": -0.4, "62": 0.8, "63": -0.5,
                    "64": 0.7, "65": -0.6, "66": 0.6, "67": -0.7, "68": 0.5, "69": -0.8, "70": 0.4, "71": -0.9,
                    "72": 0.3, "73": -0.1, "74": 0.2, "75": -0.2, "76": 0.1, "77": -0.3, "78": 0.0, "79": -0.4,
                    "80": 0.9, "81": -0.5, "82": 0.8, "83": -0.6, "84": 0.7, "85": -0.7, "86": 0.6, "87": -0.8,
                    "88": 0.5, "89": -0.9, "90": 0.4, "91": -0.1, "92": 0.3, "93": -0.2, "94": 0.2, "95": -0.3,
                    "96": 0.1, "97": -0.4, "98": 0.0, "99": -0.5, "100": 0.9, "101": -0.6, "102": 0.8, "103": -0.7,
                    "104": 0.7, "105": -0.8, "106": 0.6, "107": -0.9, "108": 0.5, "109": -0.1, "110": 0.4, "111": -0.2,
                    "112": 0.3, "113": -0.3, "114": 0.2, "115": -0.4, "116": 0.1, "117": -0.5, "118": 0.0, "119": -0.6,
                    "120": 0.9, "121": -0.7, "122": 0.8, "123": -0.8, "124": 0.7, "125": -0.9, "126": 0.6, "127": -0.1
                }
            }
        ]
    }
];

async function addTestUsers() {
    console.log('Adding test users with different face descriptors...');
    
    for (const user of sampleUsers) {
        try {
            // Insert user
            const userId = await new Promise((resolve, reject) => {
                db.run(
                    'INSERT INTO users (name, email, user_id, department) VALUES (?, ?, ?, ?)',
                    [user.name, user.email, user.userId, user.department],
                    function(err) {
                        if (err) reject(err);
                        else resolve(this.lastID);
                    }
                );
            });
            
            console.log(`‚úÖ Added user: ${user.name} (ID: ${userId})`);
            
            // Insert face descriptors
            for (const face of user.faces) {
                await new Promise((resolve, reject) => {
                    db.run(
                        'INSERT INTO user_faces (user_id, face_image, face_descriptor) VALUES (?, ?, ?)',
                        [userId, 'test-face-image', JSON.stringify(face.descriptor)],
                        function(err) {
                            if (err) reject(err);
                            else resolve();
                        }
                    );
                });
            }
            
            console.log(`‚úÖ Added ${user.faces.length} face descriptors for ${user.name}`);
            
        } catch (error) {
            console.error(`‚ùå Error adding ${user.name}:`, error);
        }
    }
    
    console.log('\nüéØ Test users added! Now you can test face differentiation:');
    console.log('1. Start the attendance system');
    console.log('2. Try taking attendance with your face (should recognize you)');
    console.log('3. The system should NOT recognize you as Alice, Bob, or Carol');
    console.log('4. Check console logs for distance comparisons');
    
    db.close();
}

// Run the test
addTestUsers().catch(console.error); 